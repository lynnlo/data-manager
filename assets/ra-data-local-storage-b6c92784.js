import{f as w}from"./ra-data-fakerest-622622f7.js";import{e as x}from"./lodash-7ec777e5.js";var f=globalThis&&globalThis.__assign||function(){return f=Object.assign||function(g){for(var r,l=1,v=arguments.length;l<v;l++){r=arguments[l];for(var u in r)Object.prototype.hasOwnProperty.call(r,u)&&(g[u]=r[u])}return g},f.apply(this,arguments)};const I=function(g){var r=g||{},l=r.defaultData,v=l===void 0?{}:l,u=r.localStorageKey,y=u===void 0?"ra-data-local-storage":u,h=r.loggingEnabled,s=h===void 0?!1:h,p=r.localStorageUpdateDelay,O=p===void 0?10:p,S=localStorage.getItem(y),e=S?JSON.parse(S):v,c=function(t){setTimeout(function(){t(),localStorage.setItem(y,JSON.stringify(e))},O)},i=w(e,s);return window==null||window.addEventListener("storage",function(t){if(t.key===y){var n=JSON.parse(t.newValue);e=n,i=w(n,s)}}),{getList:function(t,n){return i.getList(t,n).catch(function(a){if(a.code===1)return{data:[],total:0};throw a})},getOne:function(t,n){return i.getOne(t,n)},getMany:function(t,n){return i.getMany(t,n)},getManyReference:function(t,n){return i.getManyReference(t,n).catch(function(a){if(a.code===1)return{data:[],total:0};throw a})},update:function(t,n){return c(function(){var a,o=(a=e[t])===null||a===void 0?void 0:a.findIndex(function(d){return d.id==n.id});e[t][o]=f(f({},e[t][o]),n.data)}),i.update(t,n)},updateMany:function(t,n){return c(function(){n.ids.forEach(function(a){var o,d=(o=e[t])===null||o===void 0?void 0:o.findIndex(function(_){return _.id==a});e[t][d]=f(f({},e[t][d]),n.data)})}),i.updateMany(t,n)},create:function(t,n){return i.create(t,n).then(function(a){return c(function(){e.hasOwnProperty(t)||(e[t]=[]),e[t].push(a.data)}),a})},delete:function(t,n){return c(function(){var a,o=(a=e[t])===null||a===void 0?void 0:a.findIndex(function(d){return d.id==n.id});x(e[t],[o])}),i.delete(t,n)},deleteMany:function(t,n){return c(function(){var a=n.ids.map(function(o){var d;return(d=e[t])===null||d===void 0?void 0:d.findIndex(function(_){return _.id==o})});x(e[t],a)}),i.deleteMany(t,n)}}};export{I as l};
